!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;((t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).braintree||(t.braintree={})).threeDSecure=e()}}(function(){return function i(s,a,c){function l(t,e){if(!a[t]){if(!s[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var o=a[t]={exports:{}};s[t][0].call(o.exports,function(e){return l(s[t][1][e]||e)},o,o.exports,i,s,a,c)}return a[t].exports}for(var u="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}({1:[function(r,n,e){(function(e){"use strict";var t=r("promise-polyfill");n.exports=e.Promise||t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"promise-polyfill":28}],2:[function(e,t,r){"use strict";var s=e("./lib/promise"),a={};function n(r){var t,n,o,e,i=JSON.stringify(r);return!r.forceScriptReload&&(e=a[i])?e:(o=document.createElement("script"),t=r.dataAttributes||{},n=r.container||document.head,o.src=r.src,o.id=r.id,o.async=!0,r.crossorigin&&o.setAttribute("crossorigin",r.crossorigin),Object.keys(t).forEach(function(e){o.setAttribute("data-"+e,t[e])}),e=new s(function(e,t){o.addEventListener("load",function(){e(o)}),o.addEventListener("error",function(){t(new Error(r.src+" failed to load."))}),o.addEventListener("abort",function(){t(new Error(r.src+" has aborted."))}),n.appendChild(o)}),a[i]=e)}n.clearCache=function(){a={}},t.exports=n},{"./lib/promise":1}],3:[function(e,t,r){"use strict";function n(){this._events={}}n.prototype.on=function(e,t){this._events[e]?this._events[e].push(t):this._events[e]=[t]},n.prototype.off=function(e,t){var r,n=this._events[e];n&&(r=n.indexOf(t),n.splice(r,1))},n.prototype._emit=function(e){var t,r=this._events[e];r&&(t=Array.prototype.slice.call(arguments,1),r.forEach(function(e){e.apply(null,t)}))},n.prototype.hasListener=function(e){var t=this._events[e];return!!t&&0<t.length},n.createChild=function(e){e.prototype=Object.create(n.prototype,{constructor:e})},t.exports=n},{}],4:[function(e,t,r){"use strict";function n(e){var t,r=this;return"function"==typeof e?new n.Promise(e):(this._promise=new n.Promise(function(e,t){r._resolveFunction=e,r._rejectFunction=t}),e=e||{},this._onResolve=e.onResolve||n.defaultOnResolve,this._onReject=e.onReject||n.defaultOnReject,((t=e).hasOwnProperty("suppressUnhandledPromiseMessage")?Boolean(t.suppressUnhandledPromiseMessage):Boolean(n.suppressUnhandledPromiseMessage))&&this._promise.catch(function(){}),this._resetState(),this._promise.resolve=this.resolve.bind(this),this._promise.reject=this.reject.bind(this),this._promise)}["all","allSettled","race","reject","resolve"].forEach(function(t){n[t]=function(){var e=Array.prototype.slice.call(arguments);return n.Promise[t].apply(n.Promise,e)}}),n.setPromise=function(e){n.Promise=e},"undefined"!=typeof Promise&&n.setPromise(Promise),n.defaultOnResolve=function(e){return n.Promise.resolve(e)},n.defaultOnReject=function(e){return n.Promise.reject(e)},n.prototype.resolve=function(e){var t=this;return this._promise.isFulfilled||(this._setResolved(),n.Promise.resolve().then(function(){return t._onResolve(e)}).then(this._resolveFunction).catch(function(e){t._resetState(),t._promise.reject(e)})),this._promise},n.prototype.reject=function(e){var t=this;return this._promise.isFulfilled||(this._setRejected(),n.Promise.resolve().then(function(){return t._onReject(e)}).then(function(e){t._setResolved(),t._resolveFunction(e)}).catch(this._rejectFunction)),this._promise},n.prototype._resetState=function(){this._promise.isFulfilled=!1,this._promise.isResolved=!1,this._promise.isRejected=!1},n.prototype._setResolved=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!0,this._promise.isRejected=!1},n.prototype._setRejected=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!1,this._promise.isRejected=!0},t.exports=n},{}],5:[function(e,t,r){"use strict";var n=e("./lib/set-attributes"),o=e("./lib/default-attributes"),i=e("./lib/assign");t.exports=function(e){var t=document.createElement("iframe"),r=i({},o,e);return r.style&&"string"!=typeof r.style&&(i(t.style,r.style),delete r.style),n(t,r),t.getAttribute("id")||(t.id=t.name),t}},{"./lib/assign":6,"./lib/default-attributes":7,"./lib/set-attributes":8}],6:[function(e,t,r){"use strict";t.exports=function(r){return Array.prototype.slice.call(arguments,1).forEach(function(t){"object"==typeof t&&Object.keys(t).forEach(function(e){r[e]=t[e]})}),r}},{}],7:[function(e,t,r){"use strict";t.exports={src:"about:blank",frameBorder:0,allowtransparency:!0,scrolling:"no"}},{}],8:[function(e,t,r){"use strict";t.exports=function(e,t){var r;for(var n in t)t.hasOwnProperty(n)&&(null==(r=t[n])?e.removeAttribute(n):e.setAttribute(n,r))}},{}],9:[function(e,t,r){"use strict";t.exports=function(t){return function(){var e=arguments;setTimeout(function(){try{t.apply(null,e)}catch(e){console.log("Error in callback function"),console.log(e)}},1)}}},{}],10:[function(e,t,r){"use strict";t.exports=function(e){var t=!1;return function(){t||(t=!0,e.apply(null,arguments))}}},{}],11:[function(e,t,r){"use strict";t.exports=function(e,t){if(!t)return e;e.then(function(e){t(null,e)}).catch(function(e){t(e)})}},{}],12:[function(e,t,r){"use strict";var n=e("./lib/deferred"),o=e("./lib/once"),i=e("./lib/promise-or-callback");function a(r){return function(){var e,t=Array.prototype.slice.call(arguments);return"function"==typeof t[t.length-1]&&(e=t.pop(),e=o(n(e))),i(r.apply(this,t),e)}}a.wrapPrototype=function(o,e){var i,s;return i=(e=e||{}).ignoreMethods||[],s=!0===e.transformPrivateMethods,Object.getOwnPropertyNames(o.prototype).filter(function(e){var t,r="constructor"!==e&&"function"==typeof o.prototype[e],n=-1===i.indexOf(e);return t=s||"_"!==e.charAt(0),r&&t&&n}).forEach(function(e){var t=o.prototype[e];o.prototype[e]=a(t)}),o},t.exports=a},{"./lib/deferred":9,"./lib/once":10,"./lib/promise-or-callback":11}],13:[function(e,t,r){"use strict";var i=e("./lib/is-not-string"),s=e("./lib/subscription-args-invalid"),a=e("./lib/broadcast"),c=e("./lib/package-payload"),l=e("./lib/constants");function n(e){void 0===e&&(e="*"),this.origin=e}t.exports=(n.prototype.include=function(e){return null!=e&&null!=e.Window&&e.constructor===e.Window&&(l.childWindows.push(e),!0)},n.prototype.target=function(e){return void 0===e&&(e="*"),new n(e)},n.prototype.emit=function(e,t,r){var n=this.origin;if(i.isntString(e))return!1;if(i.isntString(n))return!1;"function"==typeof t&&(r=t,t=void 0);var o=c.packagePayload(e,n,t,r);return!!o&&(a.broadcast(window.top||window.self,o,n),!0)},n.prototype.on=function(e,t){var r=this.origin;return!s.subscriptionArgsInvalid(e,t,r)&&(l.subscribers[r]=l.subscribers[r]||{},l.subscribers[r][e]=l.subscribers[r][e]||[],l.subscribers[r][e].push(t),!0)},n.prototype.off=function(e,t){var r=this.origin;if(s.subscriptionArgsInvalid(e,t,r))return!1;var n=l.subscribers[r]&&l.subscribers[r][e];if(!n)return!1;for(var o=0;o<n.length;o++)if(n[o]===t)return n.splice(o,1),!0;return!1},n)},{"./lib/broadcast":17,"./lib/constants":18,"./lib/is-not-string":21,"./lib/package-payload":23,"./lib/subscription-args-invalid":25}],14:[function(e,t,r){"use strict";var n=e("./lib/attach"),o=new(e("./framebus"));n.attach(),t.exports=o},{"./framebus":13,"./lib/attach":15}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.detach=r.attach=void 0;var n=e("./message"),o=!1;r.attach=function(){o||"undefined"==typeof window||(o=!0,window.addEventListener("message",n.onmessage,!1))},r.detach=function(){o=!1,window.removeEventListener("message",n.onmessage,!1)}},{"./message":22}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.broadcastToChildWindows=void 0;var i=e("./broadcast"),s=e("./constants");r.broadcastToChildWindows=function(e,t,r){for(var n=s.childWindows.length-1;0<=n;n--){var o=s.childWindows[n];o.closed?s.childWindows.splice(n,1):r!==o&&i.broadcast(o.top,e,t)}}},{"./broadcast":17,"./constants":18}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.broadcast=void 0;var s=e("./has-opener");r.broadcast=function e(t,r,n){var o,i=0;try{for(t.postMessage(r,n),s.hasOpener(t)&&e(t.opener.top,r,n);o=t.frames[i];)e(o,r,n),i++}catch(e){}}},{"./has-opener":20}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.subscribers=r.childWindows=r.prefix=void 0,r.prefix="/*framebus*/",r.childWindows=[],r.subscribers={}},{}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.dispatch=void 0;var a=e("./constants");r.dispatch=function(e,t,r,n,o){if(a.subscribers[e]&&a.subscribers[e][t]){var i=[];r&&i.push(r),n&&i.push(n);for(var s=0;s<a.subscribers[e][t].length;s++)a.subscribers[e][t][s].apply(o,i)}}},{"./constants":18}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hasOpener=void 0,r.hasOpener=function(e){return e.top===e&&(null!=e.opener&&(e.opener!==e&&!0!==e.opener.closed))}},{}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isntString=void 0,r.isntString=function(e){return"string"!=typeof e}},{}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.onmessage=void 0;var o=e("./is-not-string"),i=e("./unpack-payload"),s=e("./dispatch"),a=e("./broadcast-to-child-windows");r.onmessage=function(e){if(!o.isntString(e.data)){var t=i.unpackPayload(e);if(t){var r=t.eventData,n=t.reply;s.dispatch("*",t.event,r,n,e),s.dispatch(e.origin,t.event,r,n,e),a.broadcastToChildWindows(e.data,t.origin,e.source)}}}},{"./broadcast-to-child-windows":16,"./dispatch":19,"./is-not-string":21,"./unpack-payload":26}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.packagePayload=void 0;var s=e("./subscribe-replier"),a=e("./constants");r.packagePayload=function(e,t,r,n){var o,i={event:e,origin:t};"function"==typeof n&&(i.reply=s.subscribeReplier(n,t)),i.eventData=r;try{o=a.prefix+JSON.stringify(i)}catch(e){throw new Error("Could not stringify event: "+e.message)}return o}},{"./constants":18,"./subscribe-replier":24}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.subscribeReplier=void 0;var s=e("../framebus"),a=e("./uuid");r.subscribeReplier=function(n,o){var i=a.uuid();return(new s).target(o).on(i,function e(t,r){n(t,r),(new s).target(o).off(i,e)}),i}},{"../framebus":13,"./uuid":27}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.subscriptionArgsInvalid=void 0;var n=e("./is-not-string");r.subscriptionArgsInvalid=function(e,t,r){return!!n.isntString(e)||("function"!=typeof t||n.isntString(r))}},{"./is-not-string":21}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.unpackPayload=void 0;var i=e("./constants"),s=e("./package-payload");r.unpackPayload=function(e){var t;if(e.data.slice(0,i.prefix.length)!==i.prefix)return!1;try{t=JSON.parse(e.data.slice(i.prefix.length))}catch(e){return!1}if(t.reply){var r=e.origin,n=e.source,o=t.reply;t.reply=function(e){if(n){var t=s.packagePayload(o,r,e);t&&n.postMessage(t,r)}}}return t}},{"./constants":18,"./package-payload":23}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.uuid=void 0,r.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}},{}],28:[function(e,t,r){"use strict";var n=setTimeout;function c(e){return Boolean(e&&void 0!==e.length)}function o(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],p(e,this)}function s(r,n){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,i._immediateFn(function(){var e=1===r._state?n.onFulfilled:n.onRejected;if(null!==e){var t;try{t=e(r._value)}catch(e){return void l(n.promise,e)}a(n.promise,t)}else(1===r._state?a:l)(n.promise,r._value)})):r._deferreds.push(n)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if(e instanceof i)return t._state=3,t._value=e,void u(t);if("function"==typeof r)return void p((n=r,o=e,function(){n.apply(o,arguments)}),t)}t._state=1,t._value=e,u(t)}catch(e){l(t,e)}var n,o}function l(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,r=e._deferreds.length;t<r;t++)s(e,e._deferreds[t]);e._deferreds=null}function d(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function p(e,t){var r=!1;try{e(function(e){r||(r=!0,a(t,e))},function(e){r||(r=!0,l(t,e))})}catch(e){if(r)return;r=!0,l(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var r=new this.constructor(o);return s(this,new d(e,t,r)),r},i.prototype.finally=function(t){var r=this.constructor;return this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){return r.reject(e)})})},i.all=function(t){return new i(function(n,o){if(!c(t))return o(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return n([]);var s=i.length;function a(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return void r.call(e,function(e){a(t,e)},o)}i[t]=e,0==--s&&n(i)}catch(e){o(e)}}for(var e=0;e<i.length;e++)a(e,i[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(r){return new i(function(e,t){t(r)})},i.race=function(o){return new i(function(e,t){if(!c(o))return t(new TypeError("Promise.race accepts an array"));for(var r=0,n=o.length;r<n;r++)i.resolve(o[r]).then(e,t)})},i._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t.exports=i},{}],29:[function(e,t,r){"use strict";var s=e("./create-authorization-data"),a=e("./json-clone"),c=e("./constants");t.exports=function(e,t){var r,n=t?a(t):{},o=s(e.authorization).attrs,i=a(e.analyticsMetadata);for(r in n.braintreeLibraryVersion=c.BRAINTREE_LIBRARY_VERSION,n._meta)n._meta.hasOwnProperty(r)&&(i[r]=n._meta[r]);return n._meta=i,o.tokenizationKey?n.tokenizationKey=o.tokenizationKey:n.authorizationFingerprint=o.authorizationFingerprint,n}},{"./constants":38,"./create-authorization-data":42,"./json-clone":49}],30:[function(e,t,r){"use strict";var n=e("./promise"),l=e("./constants"),u=e("./add-metadata");t.exports={sendEvent:function(e,s,a){var c=Date.now();return n.resolve(e).then(function(e){var t=Date.now(),r=e.getConfiguration(),n=e._request,o=r.gatewayConfiguration.analytics.url,i={analytics:[{kind:l.ANALYTICS_PREFIX+s,isAsync:Math.floor(t/1e3)!==Math.floor(c/1e3),timestamp:c}]};n({url:o,method:"post",data:u(r,i),timeout:l.ANALYTICS_REQUEST_TIMEOUT_MS},a)})}}},{"./add-metadata":29,"./constants":38,"./promise":51}],31:[function(e,t,r){"use strict";var n=e("@braintree/asset-loader/load-script");t.exports={loadScript:n}},{"@braintree/asset-loader/load-script":2}],32:[function(e,t,r){"use strict";var n="function"==typeof Object.assign?Object.assign:o;function o(e){var t,r,n;for(t=1;t<arguments.length;t++)for(n in r=arguments[t])r.hasOwnProperty(n)&&(e[n]=r[n]);return e}t.exports={assign:n,_assign:o}},{}],33:[function(e,t,r){"use strict";var o=e("./braintree-error"),i=e("./promise"),s=e("./errors");t.exports={verify:function(e){var t,r,n;return e?(n=e.name,t=e.client,r=e.authorization,t||r?r||"3.63.0"===t.getVersion()?i.resolve():i.reject(new o({type:s.INCOMPATIBLE_VERSIONS.type,code:s.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+t.getVersion()+") and "+n+" (version 3.63.0) components must be from the same SDK version."})):i.reject(new o({type:s.INSTANTIATION_OPTION_REQUIRED.type,code:s.INSTANTIATION_OPTION_REQUIRED.code,message:"options.client is required when instantiating "+n+"."}))):i.reject(new o({type:s.INVALID_USE_OF_INTERNAL_FUNCTION.type,code:s.INVALID_USE_OF_INTERNAL_FUNCTION.code,message:"Options must be passed to basicComponentVerification function."}))}}},{"./braintree-error":34,"./errors":46,"./promise":51}],34:[function(e,t,r){"use strict";var n=e("./enumerate");function o(e){if(!o.types.hasOwnProperty(e.type))throw new Error(e.type+" is not a valid type.");if(!e.code)throw new Error("Error code required.");if(!e.message)throw new Error("Error message required.");this.name="BraintreeError",this.code=e.code,this.message=e.message,this.type=e.type,this.details=e.details}o.prototype=Object.create(Error.prototype),(o.prototype.constructor=o).types=n(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]),o.findRootError=function(e){return e instanceof o&&e.details&&e.details.originalError?o.findRootError(e.details.originalError):e},t.exports=o},{"./enumerate":45}],35:[function(e,t,r){"use strict";var o=e("../is-verified-domain");t.exports={checkOrigin:function(e,t){var r,n=document.createElement("a");return n.href=t,r="https:"===n.protocol?n.host.replace(/:443$/,""):"http:"===n.protocol?n.host.replace(/:80$/,""):n.host,n.protocol+"//"+r===e||(n.href=e,o(e))}}},{"../is-verified-domain":48}],36:[function(e,t,r){"use strict";var n=e("../enumerate");t.exports=n(["CONFIGURATION_REQUEST"],"bus:")},{"../enumerate":45}],37:[function(e,t,r){"use strict";var s=e("framebus"),n=e("./events"),a=e("./check-origin").checkOrigin,o=e("../braintree-error");function i(e){if(e=e||{},this.channel=e.channel,!this.channel)throw new o({type:o.types.INTERNAL,code:"MISSING_CHANNEL_ID",message:"Channel ID must be specified."});this.merchantUrl=e.merchantUrl,this._isDestroyed=!1,this._isVerbose=!1,this._listeners=[],this._log("new bus on channel "+this.channel,[location.href])}i.prototype.on=function(e,t){var r,n,o=t,i=this;this._isDestroyed||(this.merchantUrl&&(o=function(){a(this.origin,i.merchantUrl)&&t.apply(this,arguments)}),r=this._namespaceEvent(e),(n=Array.prototype.slice.call(arguments))[0]=r,n[1]=o,this._log("on",n),s.on.apply(s,n),this._listeners.push({eventName:e,handler:o,originalHandler:t}))},i.prototype.emit=function(e){var t;this._isDestroyed||((t=Array.prototype.slice.call(arguments))[0]=this._namespaceEvent(e),this._log("emit",t),s.emit.apply(s,t))},i.prototype._offDirect=function(e){var t=Array.prototype.slice.call(arguments);this._isDestroyed||(t[0]=this._namespaceEvent(e),this._log("off",t),s.off.apply(s,t))},i.prototype.off=function(e,t){var r,n,o=t;if(!this._isDestroyed){if(this.merchantUrl)for(r=0;r<this._listeners.length;r++)(n=this._listeners[r]).originalHandler===t&&(o=n.handler);this._offDirect(e,o)}},i.prototype._namespaceEvent=function(e){return["braintree",this.channel,e].join(":")},i.prototype.teardown=function(){var e,t;for(t=0;t<this._listeners.length;t++)e=this._listeners[t],this._offDirect(e.eventName,e.handler);this._listeners.length=0,this._isDestroyed=!0},i.prototype._log=function(e,t){this._isVerbose&&console.log(e,t)},i.events=n,t.exports=i},{"../braintree-error":34,"./check-origin":35,"./events":36,framebus:14}],38:[function(e,t,r){"use strict";t.exports={ANALYTICS_PREFIX:"web.",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:{production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"},CLIENT_API_URLS:{production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"},FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",GRAPHQL_URLS:{production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"},INTEGRATION_TIMEOUT_MS:6e4,VERSION:"3.63.0",INTEGRATION:"custom",SOURCE:"client",PLATFORM:"web",BRAINTREE_LIBRARY_VERSION:"braintree/web/3.63.0"}},{}],39:[function(e,t,r){"use strict";var n=e("./braintree-error"),o=e("./errors");t.exports=function(t,e){e.forEach(function(e){t[e]=function(){throw new n({type:o.METHOD_CALLED_AFTER_TEARDOWN.type,code:o.METHOD_CALLED_AFTER_TEARDOWN.code,message:e+" cannot be called after teardown."})}})}},{"./braintree-error":34,"./errors":46}],40:[function(e,t,r){"use strict";var n=e("./braintree-error");t.exports=function(e,t){return e instanceof n?e:new n({type:t.type,code:t.code,message:t.message,details:{originalError:e}})}},{"./braintree-error":34}],41:[function(e,t,r){"use strict";var n=e("./constants").ASSETS_URLS;t.exports={create:function(e){return n.production}}},{"./constants":38}],42:[function(e,t,r){"use strict";var s=e("../lib/vendor/polyfill").atob,a=e("../lib/constants").CLIENT_API_URLS;t.exports=function(e){var t,r,n,o,i={attrs:{},configUrl:""};return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(e)?(n=e.split("_"),o=n[0],r={merchantId:n.slice(2).join("_"),environment:o},i.environment=r.environment,i.attrs.tokenizationKey=e,i.configUrl=a[r.environment]+"/merchants/"+r.merchantId+"/client_api/v1/configuration"):(t=JSON.parse(s(e)),i.environment=t.environment,i.attrs.authorizationFingerprint=t.authorizationFingerprint,i.configUrl=t.configUrl,i.graphQL=t.graphQL),i}},{"../lib/constants":38,"../lib/vendor/polyfill":53}],43:[function(e,t,r){"use strict";var n=e("./braintree-error"),o=e("./promise"),i=e("./assets"),s=e("./errors"),a="3.63.0";t.exports={create:function(e){var t=o.resolve();return e.client?o.resolve(e.client):(window.braintree&&window.braintree.client||(t=i.loadScript({src:e.assetsUrl+"/web/"+a+"/js/client.min.js"}).catch(function(e){return o.reject(new n({type:s.CLIENT_SCRIPT_FAILED_TO_LOAD.type,code:s.CLIENT_SCRIPT_FAILED_TO_LOAD.code,message:s.CLIENT_SCRIPT_FAILED_TO_LOAD.message,details:{originalError:e}}))})),t.then(function(){return window.braintree.client.VERSION!==a?o.reject(new n({type:s.INCOMPATIBLE_VERSIONS.type,code:s.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+window.braintree.client.VERSION+") and "+e.name+" (version "+a+") components must be from the same SDK version."})):window.braintree.client.create({authorization:e.authorization,debug:e.debug})}))}}},{"./assets":31,"./braintree-error":34,"./errors":46,"./promise":51}],44:[function(e,t,r){"use strict";t.exports=function(t){return function(){var e=arguments;setTimeout(function(){t.apply(null,e)},1)}}},{}],45:[function(e,t,r){"use strict";t.exports=function(e,r){return r=null==r?"":r,e.reduce(function(e,t){return e[t]=r+t,e},{})}},{}],46:[function(e,t,r){"use strict";var n=e("./braintree-error");t.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:n.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:n.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:n.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:n.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:n.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"}}},{"./braintree-error":34}],47:[function(e,t,r){"use strict";t.exports={isHTTPS:function(e){return"https:"===(e=e||window.location.protocol)}}},{}],48:[function(e,t,r){"use strict";var n,o={"paypal.com":1,"braintreepayments.com":1,"braintreegateway.com":1,"braintree-api.com":1};t.exports=function(e){var t;return e=e.toLowerCase(),!!/^https:/.test(e)&&((n=n||document.createElement("a")).href=e,t=n.hostname.split(".").slice(-2).join("."),o.hasOwnProperty(t))}},{}],49:[function(e,t,r){"use strict";t.exports=function(e){return JSON.parse(JSON.stringify(e))}},{}],50:[function(e,t,r){"use strict";t.exports=function(t){return Object.keys(t).filter(function(e){return"function"==typeof t[e]})}},{}],51:[function(e,t,r){"use strict";var n=e("promise-polyfill"),o=e("@braintree/extended-promise"),i="undefined"!=typeof Promise?Promise:n;o.suppressUnhandledPromiseMessage=!0,o.setPromise(i),t.exports=i},{"@braintree/extended-promise":4,"promise-polyfill":28}],52:[function(e,t,r){"use strict";t.exports=function(e){return e?"":".min"}},{}],53:[function(e,t,r){"use strict";var n="function"==typeof atob?window.atob:o;function o(e){var t,r,n,o,i,s,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";if(!new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$").test(e))throw new Error("Non base64 encoded input passed to window.atob polyfill");for(s=0;t=(63&a.indexOf(e.charAt(s++)))<<2|(o=a.indexOf(e.charAt(s++)))>>4&3,r=(15&o)<<4|(i=a.indexOf(e.charAt(s++)))>>2&15,n=(3&i)<<6|63&a.indexOf(e.charAt(s++)),c+=String.fromCharCode(t)+(r?String.fromCharCode(r):"")+(n?String.fromCharCode(n):""),s<e.length;);return c}t.exports={atob:function(e){return n.call(window,e)},_atob:o}},{}],54:[function(e,t,r){"use strict";t.exports=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}},{}],55:[function(e,t,r){"use strict";var n=e("../../../lib/assign").assign,i=e("../../../lib/analytics"),s=e("../../../lib/braintree-error"),a=e("../../../lib/promise"),o=e("@braintree/extended-promise"),c=e("@braintree/event-emitter"),l=e("../../shared/errors"),u=e("@braintree/iframer"),d=e("../../../lib/bus"),p=e("../../shared/constants"),f=e("../../../lib/vendor/uuid"),_=e("../../shared/events"),h=e("../../../lib/use-min");function m(e){c.call(this),this._client=e.client,this._createPromise=e.createPromise,this._createOptions=e,this._client?(this._isDebug=this._client.getConfiguration().isDebug,this._assetsUrl=this._client.getConfiguration().gatewayConfiguration.assetsUrl):(this._isDebug=Boolean(e.isDebug),this._assetsUrl=e.assetsUrl),this._assetsUrl=this._assetsUrl+"/web/3.63.0"}c.createChild(m),m.prototype._waitForClient=function(){return this._client?a.resolve():this._createPromise.then(function(e){this._client=e}.bind(this))},m.prototype.setUpEventListeners=function(){throw new s(l.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},m.prototype.verifyCard=function(e,t){var r,n,o=this;return t=t||{},(n=this._checkForVerifyCardError(e,t))?a.reject(n):(this._verifyCardInProgress=!0,r=this._formatVerifyCardOptions(e),this._formatLookupData(r).then(function(e){return i.sendEvent(o._createPromise,"three-d-secure.verification-flow.started"),o._performLookup(r.nonce,e)}).then(function(e){return i.sendEvent(o._createPromise,"three-d-secure.verification-flow.3ds-version."+e.lookup.threeDSecureVersion),o._onLookupComplete(e,r)}).then(function(e){return o.initializeChallengeWithLookupResponse(e,r)}).then(function(e){return o._resetVerificationState(),i.sendEvent(o._createPromise,"three-d-secure.verification-flow.completed"),e}).catch(function(e){return o._resetVerificationState(),i.sendEvent(o._createPromise,"three-d-secure.verification-flow.failed"),a.reject(e)}))},m.prototype._checkForFrameworkSpecificVerifyCardErrors=function(){throw new s(l.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},m.prototype._presentChallenge=function(){throw new s(l.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},m.prototype.prepareLookup=function(){throw new s(l.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},m.prototype._resetVerificationState=function(){this._verifyCardInProgress=!1,this._verifyCardPromisePlus=null},m.prototype._performLookup=function(e,t){var o=this,r="payment_methods/"+e+"/three_d_secure/lookup";return this._waitForClient().then(function(){return o._client.request({endpoint:r,method:"post",data:t}).catch(function(e){var t,r=e&&e.details&&e.details.httpStatus,n="three-d-secure.verification-flow.lookup-failed";return 404===r?(t=l.THREEDS_LOOKUP_TOKENIZED_CARD_NOT_FOUND_ERROR,n+=".404"):422===r?(t=l.THREEDS_LOOKUP_VALIDATION_ERROR,n+=".422"):t=l.THREEDS_LOOKUP_ERROR,i.sendEvent(o._createPromise,n),a.reject(new s({type:t.type,code:t.code,message:t.message,details:{originalError:e}}))})})},m.prototype._checkForVerifyCardError=function(e,t){var r;return!0===this._verifyCardInProgress?new s(l.THREEDS_AUTHENTICATION_IN_PROGRESS):(e.nonce?e.amount||(r="an amount"):r="a nonce",(r=r||this._checkForFrameworkSpecificVerifyCardErrors(e,t))?new s({type:l.THREEDS_MISSING_VERIFY_CARD_OPTION.type,code:l.THREEDS_MISSING_VERIFY_CARD_OPTION.code,message:"verifyCard options must include "+r+"."}):null)},m.prototype.initializeChallengeWithLookupResponse=function(e,t){var r=this;return t=t||{},this._lookupPaymentMethod=e.paymentMethod,r._verifyCardPromisePlus=r._verifyCardPromisePlus||new o,r._handleLookupResponse(e,t),r._verifyCardPromisePlus.then(function(e){return i.sendEvent(r._createPromise,"three-d-secure.verification-flow.liability-shifted."+String(e.liabilityShifted)),i.sendEvent(r._createPromise,"three-d-secure.verification-flow.liability-shift-possible."+String(e.liabilityShiftPossible)),e})},m.prototype._handleLookupResponse=function(e,t){var r,n=Boolean(e.lookup&&e.lookup.acsUrl);i.sendEvent(this._createPromise,"three-d-secure.verification-flow.challenge-presented."+String(n)),n?this._presentChallenge(e,t):((r=this._formatAuthResponse(e.paymentMethod,e.threeDSecureInfo)).verificationDetails=e.threeDSecureInfo,this._verifyCardPromisePlus.resolve(r))},m.prototype._onLookupComplete=function(e){return this._lookupPaymentMethod=e.paymentMethod,this._verifyCardPromisePlus=new o,a.resolve(e)},m.prototype._formatAuthResponse=function(e,t){return{nonce:e.nonce,binData:e.binData,details:e.details,description:e.description&&e.description.replace(/\+/g," "),liabilityShifted:t&&t.liabilityShifted,liabilityShiftPossible:t&&t.liabilityShiftPossible,threeDSecureInfo:e.threeDSecureInfo}},m.prototype._formatVerifyCardOptions=function(e){return n({},e)},m.prototype._formatLookupData=function(e){var t={amount:e.amount};return a.resolve(t)},m.prototype._handleV1AuthResponse=function(e){var t=JSON.parse(e.auth_response);t.success?this._verifyCardPromisePlus.resolve(this._formatAuthResponse(t.paymentMethod,t.threeDSecureInfo)):t.threeDSecureInfo&&t.threeDSecureInfo.liabilityShiftPossible?this._verifyCardPromisePlus.resolve(this._formatAuthResponse(this._lookupPaymentMethod,t.threeDSecureInfo)):this._verifyCardPromisePlus.reject(new s({type:s.types.UNKNOWN,code:"UNKNOWN_AUTH_RESPONSE",message:t.error.message}))},m.prototype.cancelVerifyCard=function(){var e,t;return this._verifyCardInProgress=!1,this._lookupPaymentMethod?(t=this._lookupPaymentMethod.threeDSecureInfo,e=n({},this._lookupPaymentMethod,{liabilityShiftPossible:t&&t.liabilityShiftPossible,liabilityShifted:t&&t.liabilityShifted,verificationDetails:t&&t.verificationDetails}),a.resolve(e)):a.reject(new s(l.THREEDS_NO_VERIFICATION_PAYLOAD))},m.prototype._setupV1Bus=function(e){var t=window.location.href.split("#")[0],r=e.lookupResponse,n=new d({channel:f(),merchantUrl:window.location.href}),o=this._assetsUrl+"/html/three-d-secure-authentication-complete-frame.html?channel="+encodeURIComponent(n.channel)+"&";return n.on(d.events.CONFIGURATION_REQUEST,function(e){e({acsUrl:r.acsUrl,pareq:r.pareq,termUrl:r.termUrl+"&three_d_secure_version=3.63.0&authentication_complete_base_url="+encodeURIComponent(o),md:r.md,parentUrl:t})}),n.on(_.AUTHENTICATION_COMPLETE,e.handleAuthResponse),n},m.prototype._setupV1Iframe=function(e){var t=this._assetsUrl+"/html/three-d-secure-bank-frame"+h(this._isDebug)+".html?showLoader="+e.showLoader;return u({src:t,height:400,width:400,name:p.LANDING_FRAME_NAME+"_"+this._v1Bus.channel,title:"3D Secure Authorization Frame"})},m.prototype._setupV1Elements=function(e){this._v1Bus=this._setupV1Bus(e),this._v1Iframe=this._setupV1Iframe(e)},m.prototype._teardownV1Elements=function(){this._v1Bus&&(this._v1Bus.teardown(),this._v1Bus=null),this._v1Iframe&&this._v1Iframe.parentNode&&(this._v1Iframe.parentNode.removeChild(this._v1Iframe),this._v1Iframe=null),this._onV1Keyup&&(document.removeEventListener("keyup",this._onV1Keyup),this._onV1Keyup=null)},m.prototype.teardown=function(){return i.sendEvent(this._createPromise,"three-d-secure.teardown-completed"),this._teardownV1Elements(),a.resolve()},t.exports=m},{"../../../lib/analytics":30,"../../../lib/assign":32,"../../../lib/braintree-error":34,"../../../lib/bus":37,"../../../lib/promise":51,"../../../lib/use-min":52,"../../../lib/vendor/uuid":54,"../../shared/constants":64,"../../shared/errors":65,"../../shared/events":66,"@braintree/event-emitter":3,"@braintree/extended-promise":4,"@braintree/iframer":5}],56:[function(e,t,r){"use strict";var n=e("./songbird");function o(e){n.call(this,e)}(o.prototype=Object.create(n.prototype,{constructor:n}))._createV1IframeModalElement=function(e){var t=document.createElement("div");return t.innerHTML='<div class="modal fade in" tabindex="-1" role="dialog" aria-labelledby="CCAFrameModal-label" aria-hidden="true" style="display: block;"><div class="modal-dialog" style="width:440px;z-index:999999;"><div class="modal-content"><div class="modal-body" data-braintree-v1-fallback-iframe-container><button type="button" data-braintree-v1-fallback-close-button class="close" data-dismiss="modal" aria-hidden="true">×</button></div></div></div><div data-braintree-v1-fallback-backdrop style="position: fixed;cursor: pointer;z-index: 999998;top: 0;left: 0;width: 100%;height: 100%;"></div></div>',t.querySelector("[data-braintree-v1-fallback-iframe-container]").appendChild(e),t},o.prototype._createCardinalConfigurationOptions=function(e){var t=n.prototype._createCardinalConfigurationOptions.call(this,e);return t.payment.framework="bootstrap3",t},t.exports=o},{"./songbird":61}],57:[function(e,t,r){"use strict";var n=e("./songbird");function o(e){n.call(this,e)}(o.prototype=Object.create(n.prototype,{constructor:n}))._createV1IframeModalElement=function(e){var t=document.createElement("div"),r=Boolean(this._createOptions&&this._createOptions.cardinalSDKConfig&&this._createOptions.cardinalSDKConfig.payment&&this._createOptions.cardinalSDKConfig.payment.displayExitButton);return t.innerHTML='<div style="position: fixed;z-index: 999999;top: 50%;left: 50%;padding: 24px 20px;transform: translate(-50%,-50%);border-radius: 2px;background: #fff;max-width: 100%;overflow: auto;"><div><button data-braintree-v1-fallback-close-button style="font-family: Helvetica,Arial,sans-serif;font-size: 25px;line-height: 12px;position: absolute;top: 2px;right: 0px;cursor: pointer;color: #999;border: 0;outline: none;background: none;" onMouseOver="this.style.color=\'#000\'" onMouseOut="this.style.color=\'#999\'">×</button></div><div data-braintree-v1-fallback-iframe-container style="height: 400px;"></div></div><div data-braintree-v1-fallback-backdrop style="position: fixed;z-index: 999998;cursor: pointer;top: 0;left: 0;width: 100%;height: 100%;transition: opacity 1ms ease;background: rgba(0,0,0,.6);"></div>',r||(t.querySelector("[data-braintree-v1-fallback-close-button]").style.display="none"),t.querySelector("[data-braintree-v1-fallback-iframe-container]").appendChild(e),t},t.exports=o},{"./songbird":61}],58:[function(e,t,r){"use strict";var n=e("./legacy"),o=e("./cardinal-modal"),i=e("./bootstrap3-modal"),s=e("./inline-iframe");t.exports={legacy:n,"cardinal-modal":o,"bootstrap3-modal":i,"inline-iframe":s}},{"./bootstrap3-modal":56,"./cardinal-modal":57,"./inline-iframe":59,"./legacy":60}],59:[function(e,t,r){"use strict";var n=e("./songbird"),s=e("../../../lib/braintree-error"),a=e("../../shared/errors"),o=e("../../../lib/enumerate");function c(e){n.call(this,e)}c.prototype=Object.create(n.prototype,{constructor:n}),c.events=o(["AUTHENTICATION_IFRAME_AVAILABLE"],"inline-iframe-framework:"),c.prototype.setUpEventListeners=function(r){n.prototype.setUpEventListeners.call(this,r),this.on(c.events.AUTHENTICATION_IFRAME_AVAILABLE,function(e,t){r("authentication-iframe-available",e,t)})},c.prototype._createCardinalConfigurationOptions=function(e){var t=n.prototype._createCardinalConfigurationOptions.call(this,e);return t.payment.framework="inline",t},c.prototype._addV1IframeToPage=function(){this._emit(c.events.AUTHENTICATION_IFRAME_AVAILABLE,{element:this._v1Modal},function(){})},c.prototype._setupFrameworkSpecificListeners=function(){this.setCardinalListener("ui.inline.setup",this._onInlineSetup.bind(this))},c.prototype._onInlineSetup=function(e,t,r,n){var o,i;e&&t&&"CCA"===t.paymentType&&("suppress"===t.data.mode||"static"===t.data.mode)||(i=!0),i?n(new s(a.THREEDS_INLINE_IFRAME_DETAILS_INCORRECT)):((o=document.createElement("div")).innerHTML=e,"suppress"===t.data.mode?(o.style.display="none",document.body.appendChild(o),r()):"static"===t.data.mode&&this._emit(c.events.AUTHENTICATION_IFRAME_AVAILABLE,{element:o},function(){r()}))},t.exports=c},{"../../../lib/braintree-error":34,"../../../lib/enumerate":45,"../../shared/errors":65,"./songbird":61}],60:[function(e,t,r){"use strict";var n=e("./base"),o=e("../../../lib/deferred");function i(e){n.call(this,e)}(i.prototype=Object.create(n.prototype,{constructor:i})).setUpEventListeners=function(){},i.prototype.transformV1CustomerBillingAddress=function(e){return e.billingAddress.line1=e.billingAddress.streetAddress,e.billingAddress.line2=e.billingAddress.extendedAddress,e.billingAddress.city=e.billingAddress.locality,e.billingAddress.state=e.billingAddress.region,e.billingAddress.countryCode=e.billingAddress.countryCodeAlpha2,delete e.billingAddress.streetAddress,delete e.billingAddress.extendedAddress,delete e.billingAddress.locality,delete e.billingAddress.region,delete e.billingAddress.countryCodeAlpha2,e},i.prototype._createIframe=function(t){var r=this;return this._setupV1Elements({lookupResponse:t.lookupResponse,showLoader:t.showLoader,handleAuthResponse:function(e){r._handleAuthResponse(e,t)}}),this._v1Iframe},i.prototype._handleAuthResponse=function(e,t){this._v1Bus.teardown(),t.removeFrame(),o(function(){this._handleV1AuthResponse(e)}.bind(this))()},i.prototype._checkForFrameworkSpecificVerifyCardErrors=function(e){var t;return"function"!=typeof e.addFrame?t="an addFrame function":"function"!=typeof e.removeFrame&&(t="a removeFrame function"),t},i.prototype._formatVerifyCardOptions=function(e){var t=n.prototype._formatVerifyCardOptions.call(this,e);return t.addFrame=o(e.addFrame),t.removeFrame=o(e.removeFrame),t.showLoader=!1!==e.showLoader,t},i.prototype._formatLookupData=function(t){var r=this;return n.prototype._formatLookupData.call(this,t).then(function(e){return t.customer&&t.customer.billingAddress&&(e.customer=r.transformV1CustomerBillingAddress(t.customer)),e})},i.prototype._presentChallenge=function(e,t){t.addFrame(null,this._createIframe({showLoader:t.showLoader,lookupResponse:e.lookup,removeFrame:t.removeFrame}))},t.exports=i},{"../../../lib/deferred":44,"./base":55}],61:[function(e,t,r){"use strict";var n=e("./base"),o=e("../../../lib/assign").assign,i=e("../../../lib/deferred"),s=e("../../../lib/braintree-error"),a=e("../../../lib/convert-to-braintree-error"),c=e("../../../lib/analytics"),l=e("../../../lib/assets"),u=e("../../shared/errors"),d=e("../../../lib/enumerate"),p=e("../../shared/constants"),f=e("../../../lib/promise"),_=e("@braintree/extended-promise"),h=e("../../../lib/constants").INTEGRATION_TIMEOUT_MS,m=e("../../../lib/constants").PLATFORM;function E(e){n.call(this,e),this._useV1Fallback=!1,this._clientMetadata={requestedThreeDSecureVersion:"2",sdkVersion:m+"/3.63.0"},this._getDfReferenceIdPromisePlus=new _,this.setupSongbird(e),this._cardinalEvents=[]}function y(e,t,r){t[r+"Line1"]=e.streetAddress,t[r+"Line2"]=e.extendedAddress,t[r+"Line3"]=e.line3,t[r+"City"]=e.locality,t[r+"State"]=e.region,t[r+"PostalCode"]=e.postalCode,t[r+"CountryCode"]=e.countryCodeAlpha2}E.prototype=Object.create(n.prototype,{constructor:E}),E.events=d(["ON_LOOKUP_COMPLETE"],"songbird-framework:"),E.prototype.setUpEventListeners=function(r){this.on(E.events.ON_LOOKUP_COMPLETE,function(e,t){r("lookup-complete",e,t)})},E.prototype.prepareLookup=function(e){var t=o({},e),r=this;return this.getDfReferenceId().then(function(e){t.dfReferenceId=e}).then(function(){return r._triggerCardinalBinProcess(e.bin)}).catch(function(){}).then(function(){return r._waitForClient()}).then(function(){return t.clientMetadata=r._clientMetadata,t.authorizationFingerprint=r._client.getConfiguration().authorizationFingerprint,t.braintreeLibraryVersion="braintree/web/3.63.0",t})},E.prototype.initializeChallengeWithLookupResponse=function(e,t){return this.setupSongbird().then(function(){return n.prototype.initializeChallengeWithLookupResponse.call(this,e,t)}.bind(this))},E.prototype._initiateV1Fallback=function(e){this._useV1Fallback=!0,c.sendEvent(this._createPromise,"three-d-secure.v1-fallback."+e),this._songbirdPromise.resolve()},E.prototype._triggerCardinalBinProcess=function(e){var t=this,r=Date.now();return e?window.Cardinal.trigger("bin.process",e).then(function(e){t._clientMetadata.issuerDeviceDataCollectionTimeElapsed=Date.now()-r,t._clientMetadata.issuerDeviceDataCollectionResult=e&&e.Status}):f.resolve()},E.prototype.transformBillingAddress=function(e,t){return t&&(y(t,e,"billing"),e.billingPhoneNumber=t.phoneNumber,e.billingGivenName=t.givenName,e.billingSurname=t.surname),e},E.prototype.transformShippingAddress=function(e){var t=e.shippingAddress;return t&&(y(t,e,"shipping"),delete e.shippingAddress),e},E.prototype._createV1IframeModalElement=function(e){var t=document.createElement("div");return t.innerHTML='<div data-braintree-v1-fallback-iframe-container="true" style="height: 400px;"></div>',t.querySelector('[data-braintree-v1-fallback-iframe-container="true"]').appendChild(e),t},E.prototype._createV1IframeModal=function(e){var t=this._createV1IframeModalElement(e),r=t.querySelector("[data-braintree-v1-fallback-close-button]"),n=t.querySelector("[data-braintree-v1-fallback-backdrop]"),o=this;function i(){t.parentNode.removeChild(t),o.cancelVerifyCard(u.THREEDS_CARDINAL_SDK_CANCELED),document.removeEventListener("keyup",o._onV1Keyup),o._onV1Keyup=null}return this._onV1Keyup=function(e){"Escape"===e.key&&t.parentNode&&i()},r&&r.addEventListener("click",i),n&&n.addEventListener("click",i),document.addEventListener("keyup",this._onV1Keyup),t},E.prototype._addV1IframeToPage=function(){document.body.appendChild(this._v1Modal)},E.prototype._handleAuthResponseFromV1Fallback=function(e){this._teardownV1Elements(),this._v1Modal.parentNode.removeChild(this._v1Modal),this._handleV1AuthResponse(e)},E.prototype._presentChallengeWithV1Fallback=function(e){var t=this;this._setupV1Elements({lookupResponse:e,showLoader:!0,handleAuthResponse:function(e){t._handleAuthResponseFromV1Fallback(e)}}),this._v1Modal=this._createV1IframeModal(this._v1Iframe),this._addV1IframeToPage()},E.prototype.setupSongbird=function(e){var r=this,t=Date.now();return this._songbirdPromise||(e=e||{},this._songbirdPromise=new _,this._v2SetupFailureReason="reason-unknown",r._loadCardinalScript(e).then(function(){return window.Cardinal?r._configureCardinalSdk({setupOptions:e,setupStartTime:t}):(r._v2SetupFailureReason="cardinal-global-unavailable",f.reject(new s(u.THREEDS_CARDINAL_SDK_SETUP_FAILED)))}).catch(function(e){var t=a(e,{type:u.THREEDS_CARDINAL_SDK_SETUP_FAILED.type,code:u.THREEDS_CARDINAL_SDK_SETUP_FAILED.code,message:u.THREEDS_CARDINAL_SDK_SETUP_FAILED.message});r._getDfReferenceIdPromisePlus.reject(t),window.clearTimeout(r._songbirdSetupTimeoutReference),c.sendEvent(r._client,"three-d-secure.cardinal-sdk.init.setup-failed"),r._initiateV1Fallback("cardinal-sdk-setup-failed."+r._v2SetupFailureReason)})),this._songbirdPromise},E.prototype._configureCardinalSdk=function(o){var i=this;return this._waitForClient().then(function(){var e=i._client.getConfiguration().gatewayConfiguration.threeDSecure.cardinalAuthenticationJWT,t=o.setupOptions,r=o.setupStartTime,n=i._createCardinalConfigurationOptions(t);i.setCardinalListener("payments.setupComplete",i._createPaymentsSetupCompleteCallback()),i._setupFrameworkSpecificListeners(),window.Cardinal.configure(n),window.Cardinal.setup("init",{jwt:e}),i._clientMetadata.cardinalDeviceDataCollectionTimeElapsed=Date.now()-r,i.setCardinalListener("payments.validated",i._createPaymentsValidatedCallback())}).catch(function(e){return i._v2SetupFailureReason="cardinal-configuration-threw-error",f.reject(e)})},E.prototype.setCardinalListener=function(e,t){this._cardinalEvents.push(e),window.Cardinal.on(e,t)},E.prototype._setupFrameworkSpecificListeners=function(){},E.prototype._createCardinalConfigurationOptions=function(e){var t=e.cardinalSDKConfig||{},r=t.payment||{};return!t.logging&&e.loggingEnabled&&(t.logging={level:"verbose"}),t.payment={},r.hasOwnProperty("displayLoading")&&(t.payment.displayLoading=r.displayLoading),r.hasOwnProperty("displayExitButton")&&(t.payment.displayExitButton=r.displayExitButton),t},E.prototype._loadCardinalScript=function(t){var r=this,n=p.CARDINAL_SCRIPT_SOURCE.sandbox;return this._waitForClient().then(function(){var e="production"===r._client.getConfiguration().gatewayConfiguration.environment;return r._songbirdSetupTimeoutReference=window.setTimeout(function(){c.sendEvent(r._client,"three-d-secure.cardinal-sdk.init.setup-timeout"),r._initiateV1Fallback("cardinal-sdk-setup-timeout")},t.timeout||h),e&&(n=p.CARDINAL_SCRIPT_SOURCE.production),l.loadScript({src:n})}).catch(function(e){return r._v2SetupFailureReason="songbird-js-failed-to-load",f.reject(a(e,u.THREEDS_CARDINAL_SDK_SCRIPT_LOAD_FAILED))})},E.prototype._createPaymentsSetupCompleteCallback=function(){var t=this;return function(e){t._getDfReferenceIdPromisePlus.resolve(e.sessionId),window.clearTimeout(t._songbirdSetupTimeoutReference),c.sendEvent(t._createPromise,"three-d-secure.cardinal-sdk.init.setup-completed"),t._songbirdPromise.resolve()}},E.prototype.getDfReferenceId=function(){return this._getDfReferenceIdPromisePlus},E.prototype._performJWTValidation=function(e){var t=this._lookupPaymentMethod.nonce,r="payment_methods/"+t+"/three_d_secure/authenticate_from_jwt",n=this;return c.sendEvent(n._createPromise,"three-d-secure.verification-flow.upgrade-payment-method.started"),this._waitForClient().then(function(){return n._client.request({method:"post",endpoint:r,data:{jwt:e,paymentMethodNonce:t}})}).then(function(e){var t=e.paymentMethod||n._lookupPaymentMethod,r=n._formatAuthResponse(t,e.threeDSecureInfo);return c.sendEvent(n._client,"three-d-secure.verification-flow.upgrade-payment-method.succeeded"),f.resolve(r)}).catch(function(e){var t=new s({type:u.THREEDS_JWT_AUTHENTICATION_FAILED.type,code:u.THREEDS_JWT_AUTHENTICATION_FAILED.code,message:u.THREEDS_JWT_AUTHENTICATION_FAILED.message,details:{originalError:e}});return c.sendEvent(n._client,"three-d-secure.verification-flow.upgrade-payment-method.errored"),f.reject(t)})},E.prototype._createPaymentsValidatedCallback=function(){var n=this;return function(e,t){var r;if(c.sendEvent(n._createPromise,"three-d-secure.verification-flow.cardinal-sdk.action-code."+e.ActionCode.toLowerCase()),n._verifyCardPromisePlus)switch(e.ActionCode){case"SUCCESS":case"NOACTION":case"FAILURE":n._performJWTValidation(t).then(function(e){n._verifyCardPromisePlus.resolve(e)}).catch(function(e){n._verifyCardPromisePlus.reject(e)});break;case"ERROR":switch(c.sendEvent(n._createPromise,"three-d-secure.verification-flow.cardinal-sdk-error."+e.ErrorNumber),e.ErrorNumber){case 10001:case 10002:r=new s(u.THREEDS_CARDINAL_SDK_SETUP_TIMEDOUT);break;case 10003:case 10007:case 10009:r=new s(u.THREEDS_CARDINAL_SDK_RESPONSE_TIMEDOUT);break;case 10005:case 10006:r=new s(u.THREEDS_CARDINAL_SDK_BAD_CONFIG);break;case 10008:case 10010:r=new s(u.THREEDS_CARDINAL_SDK_BAD_JWT);break;case 10011:c.sendEvent(n._createPromise,"three-d-secure.verification-flow.canceled"),r=new s(u.THREEDS_CARDINAL_SDK_CANCELED);break;default:r=new s(u.THREEDS_CARDINAL_SDK_ERROR)}r.details={originalError:{code:e.ErrorNumber,description:e.ErrorDescription}},n._verifyCardPromisePlus.reject(r)}else n._initiateV1Fallback("cardinal-sdk-setup-error.number-"+e.ErrorNumber)}},E.prototype._checkForVerifyCardError=function(e,t){return n.prototype._checkForVerifyCardError.call(this,e,t)},E.prototype._checkForFrameworkSpecificVerifyCardErrors=function(e,t){var r;return"function"==typeof e.onLookupComplete||t.ignoreOnLookupCompleteRequirement||(r="an onLookupComplete function"),r},E.prototype._formatVerifyCardOptions=function(e){var t=n.prototype._formatVerifyCardOptions.call(this,e),r=t.additionalInformation||{};return r=this.transformBillingAddress(r,e.billingAddress),r=this.transformShippingAddress(r),e.onLookupComplete&&(t.onLookupComplete=i(e.onLookupComplete)),e.email&&(r.email=e.email),e.mobilePhoneNumber&&(r.mobilePhoneNumber=e.mobilePhoneNumber),t.additionalInformation=r,t},E.prototype._onLookupComplete=function(e,o){var i=this;return n.prototype._onLookupComplete.call(this,e).then(function(n){return new f(function(e,t){function r(){e(n)}n.requiresUserAuthentication=Boolean(n.lookup&&n.lookup.acsUrl),i._verifyCardPromisePlus.catch(t),o.onLookupComplete?o.onLookupComplete(n,r):i._emit(E.events.ON_LOOKUP_COMPLETE,n,r)})})},E.prototype._presentChallenge=function(e){this._useV1Fallback?this._presentChallengeWithV1Fallback(e.lookup):window.Cardinal.continue("cca",{AcsUrl:e.lookup.acsUrl,Payload:e.lookup.pareq},{OrderDetails:{TransactionId:e.lookup.transactionId}})},E.prototype._formatLookupData=function(t){var r=this;return n.prototype._formatLookupData.call(this,t).then(function(e){return e.additionalInfo=t.additionalInformation,t.challengeRequested&&(e.challengeRequested=t.challengeRequested),t.exemptionRequested&&(e.exemptionRequested=t.exemptionRequested),t.bin&&(e.bin=t.bin),r.prepareLookup(e)})},E.prototype.cancelVerifyCard=function(t){var r=this;return n.prototype.cancelVerifyCard.call(this).then(function(e){return r._verifyCardPromisePlus&&(t=t||new s(u.THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT),r._verifyCardPromisePlus.reject(t)),e})},E.prototype.teardown=function(){return window.Cardinal&&this._cardinalEvents.forEach(function(e){window.Cardinal.off(e)}),n.prototype.teardown.call(this)},t.exports=E},{"../../../lib/analytics":30,"../../../lib/assets":31,"../../../lib/assign":32,"../../../lib/braintree-error":34,"../../../lib/constants":38,"../../../lib/convert-to-braintree-error":40,"../../../lib/deferred":44,"../../../lib/enumerate":45,"../../../lib/promise":51,"../../shared/constants":64,"../../shared/errors":65,"./base":55,"@braintree/extended-promise":4}],62:[function(e,t,r){"use strict";var n=e("@braintree/wrap-promise"),o=e("../../lib/methods"),i=e("../../lib/convert-methods-to-error"),s=e("@braintree/event-emitter"),a=e("./frameworks");function c(e){var t=this,r=a[e.framework];s.call(this),this._framework=new r(e),this._framework.setUpEventListeners(function(){t._emit.apply(t,arguments)})}s.createChild(c),c.prototype.verifyCard=function(e){var t;return this.hasListener("lookup-complete")&&(t={ignoreOnLookupCompleteRequirement:!0}),this._framework.verifyCard(e,t)},c.prototype.initializeChallengeWithLookupResponse=function(e){return"string"==typeof e&&(e=JSON.parse(e)),this._framework.initializeChallengeWithLookupResponse(e)},c.prototype.prepareLookup=function(e){return this._framework.prepareLookup(e).then(function(e){return JSON.stringify(e)})},c.prototype.cancelVerifyCard=function(){return this._framework.cancelVerifyCard()},c.prototype.teardown=function(){var e=o(c.prototype).concat(o(s.prototype));return i(this,e),this._framework.teardown()},t.exports=n.wrapPrototype(c)},{"../../lib/convert-methods-to-error":39,"../../lib/methods":50,"./frameworks":58,"@braintree/event-emitter":3,"@braintree/wrap-promise":12}],63:[function(e,t,r){"use strict";var s=e("./external/three-d-secure"),a=e("../lib/is-https").isHTTPS,o=e("../lib/basic-component-verification"),c=e("../lib/create-deferred-client"),l=e("../lib/create-assets-url"),u=e("../lib/braintree-error"),d=e("../lib/analytics"),p=e("./shared/errors"),f=e("../lib/promise"),n=e("@braintree/wrap-promise");t.exports={create:n(function(i){var n="3D Secure";return o.verify({name:n,client:i.client,authorization:i.authorization}).then(function(){var e=l.create(i.authorization),o=function(e){var t=String(e.version||"");if(!t||"1"===t)return"legacy";switch(t){case"2":case"2-cardinal-modal":return"cardinal-modal";case"2-bootstrap3-modal":return"bootstrap3-modal";case"2-inline-iframe":return"inline-iframe";default:throw new u({code:p.THREEDS_UNRECOGNIZED_VERSION.code,type:p.THREEDS_UNRECOGNIZED_VERSION.type,message:"Version `"+e.version+"` is not a recognized version. You may need to update the version of your Braintree SDK to support this version."})}}(i),t=c.create({authorization:i.authorization,client:i.client,debug:i.debug,assetsUrl:e,name:n}).then(function(e){var t,r=e.getConfiguration(),n=r.gatewayConfiguration;return i.client=e,n.threeDSecureEnabled||(t=p.THREEDS_NOT_ENABLED),"TOKENIZATION_KEY"===r.authorizationType&&(t=p.THREEDS_CAN_NOT_USE_TOKENIZATION_KEY),"production"===n.environment&&!a()&&(t=p.THREEDS_HTTPS_REQUIRED),"legacy"===o||n.threeDSecure&&n.threeDSecure.cardinalAuthenticationJWT||(d.sendEvent(i.client,"three-d-secure.initialization.failed.missing-cardinalAuthenticationJWT"),t=p.THREEDS_NOT_ENABLED_FOR_V2),t?f.reject(new u(t)):(d.sendEvent(i.client,"three-d-secure.initialized"),e)}),r=new s({client:i.client,assetsUrl:e,createPromise:t,loggingEnabled:i.loggingEnabled,cardinalSDKConfig:i.cardinalSDKConfig,framework:o});return i.client?t.then(function(){return r}):r})}),VERSION:"3.63.0"}},{"../lib/analytics":30,"../lib/basic-component-verification":33,"../lib/braintree-error":34,"../lib/create-assets-url":41,"../lib/create-deferred-client":43,"../lib/is-https":47,"../lib/promise":51,"./external/three-d-secure":62,"./shared/errors":65,"@braintree/wrap-promise":12}],64:[function(e,t,r){"use strict";t.exports={LANDING_FRAME_NAME:"braintreethreedsecurelanding",CARDINAL_SCRIPT_SOURCE:{production:"https://songbird.cardinalcommerce.com/edge/v1/songbird.js",sandbox:"https://songbirdstag.cardinalcommerce.com/edge/v1/songbird.js"}}},{}],65:[function(e,t,r){"use strict";var n=e("../../lib/braintree-error");t.exports={THREEDS_NOT_ENABLED:{type:n.types.MERCHANT,code:"THREEDS_NOT_ENABLED",message:"3D Secure is not enabled for this merchant."},THREEDS_CAN_NOT_USE_TOKENIZATION_KEY:{type:n.types.MERCHANT,code:"THREEDS_CAN_NOT_USE_TOKENIZATION_KEY",message:"3D Secure can not use a tokenization key for authorization."},THREEDS_HTTPS_REQUIRED:{type:n.types.MERCHANT,code:"THREEDS_HTTPS_REQUIRED",message:"3D Secure requires HTTPS."},THREEDS_NOT_ENABLED_FOR_V2:{type:n.types.MERCHANT,code:"THREEDS_NOT_ENABLED_FOR_V2",message:"3D Secure version 2 is not enabled for this merchant. Contact Braintree Support for assistance at https://help.braintreepayments.com/"},THREEDS_UNRECOGNIZED_VERSION:{type:n.types.MERCHANT,code:"THREEDS_UNRECOGNIZED_VERSION"},THREEDS_CARDINAL_SDK_SETUP_FAILED:{type:n.types.UNKNOWN,code:"THREEDS_CARDINAL_SDK_SETUP_FAILED",message:"Something went wrong setting up Cardinal's Songbird.js library."},THREEDS_CARDINAL_SDK_SCRIPT_LOAD_FAILED:{type:n.types.NETWORK,code:"THREEDS_CARDINAL_SDK_SCRIPT_LOAD_FAILED",message:"Cardinal's Songbird.js library could not be loaded."},THREEDS_CARDINAL_SDK_SETUP_TIMEDOUT:{type:n.types.UNKNOWN,code:"THREEDS_CARDINAL_SDK_SETUP_TIMEDOUT",message:"Cardinal's Songbird.js took too long to setup."},THREEDS_CARDINAL_SDK_RESPONSE_TIMEDOUT:{type:n.types.UNKNOWN,code:"THREEDS_CARDINAL_SDK_RESPONSE_TIMEDOUT",message:"Cardinal's API took too long to respond."},THREEDS_CARDINAL_SDK_BAD_CONFIG:{type:n.types.MERCHANT,code:"THREEDS_CARDINAL_SDK_BAD_CONFIG",message:"JWT or other required field missing. Please check your setup configuration."},THREEDS_CARDINAL_SDK_BAD_JWT:{type:n.types.MERCHANT,code:"THREEDS_CARDINAL_SDK_BAD_JWT",message:"Cardinal JWT missing or malformed. Please check your setup configuration."},THREEDS_CARDINAL_SDK_ERROR:{type:n.types.UNKNOWN,code:"THREEDS_CARDINAL_SDK_ERROR",message:"A general error has occurred with Cardinal. See description for more information."},THREEDS_CARDINAL_SDK_CANCELED:{type:n.types.CUSTOMER,code:"THREEDS_CARDINAL_SDK_CANCELED",message:"Canceled by user."},THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT:{type:n.types.MERCHANT,code:"THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT",message:"3D Secure verfication canceled by merchant."},THREEDS_AUTHENTICATION_IN_PROGRESS:{type:n.types.MERCHANT,code:"THREEDS_AUTHENTICATION_IN_PROGRESS",message:"Cannot call verifyCard while existing authentication is in progress."},THREEDS_MISSING_VERIFY_CARD_OPTION:{type:n.types.MERCHANT,code:"THREEDS_MISSING_VERIFY_CARD_OPTION"},THREEDS_JWT_AUTHENTICATION_FAILED:{type:n.types.UNKNOWN,code:"THREEDS_JWT_AUTHENTICATION_FAILED",message:"Something went wrong authenticating the JWT from Cardinal"},THREEDS_LOOKUP_TOKENIZED_CARD_NOT_FOUND_ERROR:{type:n.types.MERCHANT,code:"THREEDS_LOOKUP_TOKENIZED_CARD_NOT_FOUND_ERROR",message:"Either the payment method nonce passed to `verifyCard` does not exist, or it was already consumed"},THREEDS_LOOKUP_VALIDATION_ERROR:{type:n.types.CUSTOMER,code:"THREEDS_LOOKUP_VALIDATION_ERROR",message:"The data passed in `verifyCard` did not pass validation checks. See details for more info"},THREEDS_LOOKUP_ERROR:{type:n.types.UNKNOWN,code:"THREEDS_LOOKUP_ERROR",message:"Something went wrong during the 3D Secure lookup"},THREEDS_INLINE_IFRAME_DETAILS_INCORRECT:{type:n.types.UNKNOWN,code:"THREEDS_INLINE_IFRAME_DETAILS_INCORRECT",message:"Something went wrong when attempting to add the authentication iframe to the page."},THREEDS_NO_VERIFICATION_PAYLOAD:{type:n.types.MERCHANT,code:"THREEDS_NO_VERIFICATION_PAYLOAD",message:"No verification payload available."},THREEDS_TERM_URL_REQUIRES_BRAINTREE_DOMAIN:{type:n.types.INTERNAL,code:"THREEDS_TERM_URL_REQUIRES_BRAINTREE_DOMAIN",message:"Term Url must be on a Braintree domain."},THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED:{type:n.types.INTERNAL,code:"THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED",message:"Method not implemented for this framework."}}},{"../../lib/braintree-error":34}],66:[function(e,t,r){"use strict";var n=e("../../lib/enumerate");t.exports=n(["AUTHENTICATION_COMPLETE"],"threedsecure:")},{"../../lib/enumerate":45}]},{},[63])(63)});